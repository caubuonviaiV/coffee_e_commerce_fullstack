import{m as g,h as k,E as R,o as c,c as F,w as D,D as L,b as t,t as a,i as q,H as X,f as _,G as P,d as p,F as b,g as B,n as J,a as K}from"./app-Bm5g5IQi.js";import{L as Q,u as W}from"./Index-BfhsCJ__.js";import{P as Y}from"./vuejs-paginate-next.es-CcEyBOmj.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */import"./index-D8ehHb0j.js";const $={components:{Layout:Q,Paginate:Y},setup(){const u=g([]),i=g([]),m=g([]),l=[{min:0,max:2e4},{min:2e4,max:5e4},{min:5e4,max:15e4}],d=g(null),f=g("popularity"),y=g(null),v=g(1),h=g(6),n=W(),r=()=>{L.get("/api/products").then(e=>{u.value=e.data,w()}).catch(e=>{console.error("There was an error fetching the products!",e)})},C=()=>{const e=`/api/products/by-category?categories=${m.value.join(",")}`;console.log("Fetching products by category with URL:",e),L.get(e).then(s=>{u.value=s.data}).catch(s=>{console.error("There was an error fetching the products by category!",s)})},w=()=>{const e={};u.value.forEach(s=>{const o=s.category;o&&(e[o.id]?e[o.id].count++:e[o.id]={name:o.name,count:1})}),i.value=e},N=()=>{v.value=1},V=e=>{m.value.includes(e)?m.value=m.value.filter(s=>s!==e):m.value.push(e),C()},M=e=>{y.value=e},S=e=>{d.value&&d.value.min===e.min&&d.value.max===e.max?d.value=null:d.value=e},I=e=>u.value.filter(s=>s.total_number/s.total_rating>=e).length,G=(e,s)=>u.value.filter(o=>o.price>=e&&o.price<=s).length,E=e=>{v.value=e},x=k(()=>{let e=[...u.value];return f.value==="rating"?e.sort((s,o)=>{const U=s.total_number/s.total_rating;return o.total_number/o.total_rating-U}):f.value==="date"?e.sort((s,o)=>new Date(o.updated_at)-new Date(s.updated_at)):f.value==="price"?e.sort((s,o)=>s.price_sale-o.price_sale):f.value==="price-desc"&&e.sort((s,o)=>o.price_sale-s.price_sale),y.value!==null&&(e=e.filter(s=>s.total_number/s.total_rating>=y.value)),d.value&&(e=e.filter(s=>s.price>=d.value.min&&s.price<=d.value.max)),e}),O=k(()=>{const e=(v.value-1)*h.value,s=e+h.value;return x.value.slice(e,s)}),j=k(()=>Math.ceil(x.value.length/h.value)),T=k(()=>(v.value-1)*h.value),z=k(()=>Math.min(T.value+h.value,x.value.length)),A=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),H=e=>{n.addToCart(e)};return r(),{products:u,categories:i,selectedCategories:m,priceRanges:l,filteredPriceRange:d,sortOption:f,filteredRating:y,currentPage:v,itemsPerPage:h,sortedProducts:x,paginatedProducts:O,pageCount:j,startIndex:T,endIndex:z,fetchProducts:r,fetchProductsByCategory:C,countProductsByCategory:w,sortProducts:N,toggleCategorySelection:V,filterByRating:M,getRatingCount:I,filterByPriceRange:S,getProductsCountInPriceRange:G,handlePageClick:E,addToCart:H,formatCurrency:A}}},tt={class:"filters_full clearfix",style:{"margin-top":"5em"}},et={class:"container"},nt={class:"count_results"},st={class:"sort_select"},lt=t("option",{value:"popularity",selected:"selected"}," Phổ biến ",-1),ot=t("option",{value:"rating"},"Đánh giá tốt nhất",-1),at=t("option",{value:"date"},"Mới nhất",-1),it=t("option",{value:"price"},"Giá: thấp đến cao",-1),ct=t("option",{value:"price-desc"}," Giá: cao đến thấp ",-1),rt=[lt,ot,at,it,ct],_t=t("a",{href:"#collapseFilters","data-toggle":"collapse",class:"btn_filters no-underline"},[t("i",{class:"icon_adjust-vert"}),t("span",null,"Filters")],-1),dt={class:"collapse filters_2",id:"collapseFilters"},ut={class:"container margin_detail"},ht={class:"row"},gt={class:"col-md-4"},mt={class:"filter_type"},vt=t("h6",null,"Danh Mục",-1),pt={class:"container_check"},ft=["value","onChange"],yt=t("span",{class:"checkmark"},null,-1),kt={class:"col-md-4"},Ct={class:"filter_type"},xt=t("h6",null,"Xếp hạng",-1),Pt={class:"container_check"},bt=t("span",{class:"checkmark"},null,-1),Rt={class:"container_check"},Bt=t("span",{class:"checkmark"},null,-1),wt={class:"container_check"},Tt=t("span",{class:"checkmark"},null,-1),Ft={class:"container_check"},Dt=t("span",{class:"checkmark"},null,-1),Lt={class:"col-md-4"},Nt={class:"filter_type"},Vt=t("h6",null,"Giá",-1),Mt={class:"container_check"},St=["onChange"],It=t("span",{class:"checkmark"},null,-1),Gt={class:"container margin_60_40"},Et={class:"row small-gutters"},Ot={class:"grid_item"},jt={key:0,class:"ribbon off"},zt=["href"],At=["src"],Ht={class:"add_cart"},Ut=["onClick"],qt={key:0,class:"rating"},Xt={key:1},Jt=t("i",{class:"icon_star"},null,-1),Kt=t("i",{class:"icon_star"},null,-1),Qt=t("i",{class:"icon_star"},null,-1),Wt=t("i",{class:"icon_star"},null,-1),Yt=t("i",{class:"icon_star"},null,-1),Zt=[Jt,Kt,Qt,Wt,Yt],$t=["href"],te={class:"price_box"},ee={class:"new_price"},ne={key:0,class:"old_price"},se={class:"row"},le={class:"col-xl-10 col-lg-10"},oe={class:"col-xl-2 col-lg-2"};function ae(u,i,m,l,d,f){const y=R("Paginate"),v=R("router-link"),h=R("Layout");return c(),F(h,null,{content:D(()=>[t("div",tt,[t("div",et,[t("div",nt," Hiển thị "+a(l.startIndex+1)+"–"+a(l.endIndex)+" của "+a(l.sortedProducts.length)+" kết quả. ",1),t("div",st,[q(t("select",{name:"sort",id:"sort","onUpdate:modelValue":i[0]||(i[0]=n=>l.sortOption=n),onChange:i[1]||(i[1]=(...n)=>l.sortProducts&&l.sortProducts(...n))},rt,544),[[X,l.sortOption]])]),_t])]),t("div",dt,[t("div",ut,[t("div",ht,[t("div",gt,[t("div",mt,[vt,t("ul",null,[(c(!0),_(b,null,P(l.categories,(n,r)=>(c(),_("li",{key:r},[t("label",pt,[p(a(n.name)+" ",1),t("small",null,a(n.count),1),t("input",{type:"checkbox",value:r,onChange:C=>l.toggleCategorySelection(r)},null,40,ft),yt])]))),128))])])]),t("div",kt,[t("div",Ct,[xt,t("ul",null,[t("li",null,[t("label",Pt,[p(" Tuyệt vời(4.5+) "),t("small",null,a(l.getRatingCount(4.5)),1),t("input",{type:"checkbox",onChange:i[2]||(i[2]=n=>l.filterByRating(4.5))},null,32),bt])]),t("li",null,[t("label",Rt,[p(" Rất tốt(4+) "),t("small",null,a(l.getRatingCount(4)),1),t("input",{type:"checkbox",onChange:i[3]||(i[3]=n=>l.filterByRating(4))},null,32),Bt])]),t("li",null,[t("label",wt,[p(" Tốt(3.5+) "),t("small",null,a(l.getRatingCount(3.5)),1),t("input",{type:"checkbox",onChange:i[4]||(i[4]=n=>l.filterByRating(3.5))},null,32),Tt])]),t("li",null,[t("label",Ft,[p(" Tạm(3+) "),t("small",null,a(l.getRatingCount(3)),1),t("input",{type:"checkbox",onChange:i[5]||(i[5]=n=>l.filterByRating(3))},null,32),Dt])])])])]),t("div",Lt,[t("div",Nt,[Vt,t("ul",null,[(c(!0),_(b,null,P(l.priceRanges,(n,r)=>(c(),_("li",{key:r},[t("label",Mt,[p(" $"+a(n.min)+" — $"+a(n.max)+" ",1),t("small",null,a(l.getProductsCountInPriceRange(n.min,n.max)),1),t("input",{type:"checkbox",onChange:C=>l.filterByPriceRange(n)},null,40,St),It])]))),128))])])])])])]),t("div",Gt,[t("div",Et,[(c(!0),_(b,null,P(l.paginatedProducts,n=>(c(),_("div",{class:"col-6 col-md-4 col-xl-3",key:n.id},[t("div",Ot,[t("figure",null,[n.price_sale?(c(),_("span",jt," -"+a(((n.price-n.price_sale)/n.price*100).toFixed(0))+"% ",1)):B("",!0),t("a",{href:"/menu/"+n.id},[t("img",{class:"img-fluid lazy",src:n.image,alt:"",style:{width:"400px",height:"320px"}},null,8,At),t("div",Ht,[t("span",{class:"btn_1",onClick:r=>l.addToCart(n)},"Add to cart",8,Ut)])],8,zt)]),n.total_rating&&n.total_number?(c(),_("div",qt,[(c(),_(b,null,P(5,r=>t("i",{class:J(["icon_star",{voted:r<=Math.round(n.total_number/n.total_rating)}]),key:r},null,2)),64))])):(c(),_("div",Xt,Zt)),t("a",{href:"/menu/"+n.id},[t("h3",null,a(n.name),1)],8,$t),t("div",te,[t("span",ee,a(n.price_sale||n.price)+"đ",1),n.price_sale?(c(),_("span",ne,a(n.price)+"đ",1)):B("",!0)])])]))),128))]),t("div",se,[t("div",le,[l.sortedProducts.length>l.itemsPerPage?(c(),F(y,{key:0,"page-count":l.pageCount,"click-handler":l.handlePageClick,"container-class":"pagination","page-class":"page-item","page-link-class":"page-link","prev-text":"«","next-text":"»"},null,8,["page-count","click-handler"])):B("",!0)]),t("div",oe,[K(v,{to:{name:"Cart"},class:"btn_1 outline"},{default:D(()=>[p("Đến giỏ hàng")]),_:1})])])])]),_:1})}const ge=Z($,[["render",ae]]);export{ge as default};
