import{m as i,k as H,E as j,o as d,c as z,w as A,D as f,b as t,f as m,t as a,d as _,g as C,G as w,F as x,i as M,B as k,Y as G,_ as P}from"./app-Bm5g5IQi.js";import{L as Y}from"./Index-BfhsCJ__.js";import{E as q}from"./ErrorMessage-Ca5XFEdV.js";import{u as J}from"./index-D8ehHb0j.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{f as I,v as O}from"./vi-Dnq-qZtZ.js";/* empty css            */const Q={name:"PostDetails",components:{Layout:Y,ErrorMessage:q},props:["postId"],setup(r){const l=i(null),v=i([]),o=i([]),g=i(""),h=i(""),u=i({name:"",email:""}),s=i([]),p=i(1),b=i(!0),L=J(),y=(n=1)=>{f.get(`/api/blog/comments/${r.postId}?page=${n}`).then(e=>{e.data.length>0?s.value=n===1?e.data:[...s.value,...e.data]:b.value=!1}).catch(e=>{console.error("Error fetching comments:",e)})},E=()=>{const n=localStorage.getItem("authToken");n?(f.defaults.headers.common.Authorization=`Bearer ${n}`,f.get("/api/user").then(e=>{u.value=e.data}).catch(e=>{console.error("Error fetching user:",e)})):h.value="Bạn chưa đăng nhập."},T=n=>{f.get(`/api/blog/posts/${n}`).then(e=>{l.value=e.data.post,v.value=e.data.latestPosts,o.value=e.data.categories}).catch(e=>{console.error("Error fetching post details:",e)})},V=n=>I(new Date(n),"dd 'tháng' MM 'năm' yyyy",{locale:O}),S=n=>I(new Date(n),"dd/MM/yyyy"),N=()=>{const{name:n,email:e}=u.value,B=g.value;if(!n||!e||!B){h.value="Vui lòng nhập đầy đủ thông tin bình luận!";return}const F=u.value.id;f.post("/api/blog/comments",{content:B,post_id:r.postId,user_id:F,name:n,email:e}).then(D=>{L.success("Bình luận đã được lưu!"),g.value="",y(1),p.value=1,b.value=!0}).catch(D=>{console.error("Lỗi khi lưu bình luận:",D),h.value="Lỗi khi lưu bình luận"})},U=()=>{p.value++,y(p.value)};return H(()=>{T(r.postId),E(),y()}),{post:l,latestPosts:v,categories:o,content:g,errorMessage:h,user:u,comments:s,hasMoreComments:b,formatDate:V,formatDateComment:S,submitComment:N,loadMoreComments:U}}},c=r=>(G("data-v-f11ba0bf"),r=r(),P(),r),R={class:"container margin_60_40"},W={class:"row"},X={class:"col-lg-9"},Z={key:0,class:"singlepost"},$=["src"],tt={class:"postmeta"},ot={href:"#"},st=c(()=>t("i",{class:"icon_folder-alt"},null,-1)),et=c(()=>t("i",{class:"icon_calendar"},null,-1)),nt={href:"#"},lt=c(()=>t("i",{class:"icon_pencil-edit"},null,-1)),at={href:"#"},ct=c(()=>t("i",{class:"icon_comment_alt"},null,-1)),it=["innerHTML"],rt={id:"comments"},dt=c(()=>t("h5",null,"Bình luận",-1)),mt=c(()=>t("div",{class:"avatar"},[t("a",{href:"#"},[t("img",{src:"img/avatar1.jpg",alt:""})])],-1)),ut={class:"comment_right clearfix"},_t={class:"comment_info"},ht=c(()=>t("span",null,"|",-1)),ft=c(()=>t("hr",null,null,-1)),gt=c(()=>t("h5",null,"Để lại một bình luận:",-1)),vt={key:1},pt={class:"row"},bt={class:"col-md-4 col-sm-6"},yt={class:"form-group"},Ct={class:"col-md-4 col-sm-6"},Mt={class:"form-group"},kt={class:"form-group"},Bt={class:"form-group"},Dt={class:"col-lg-3"},wt={class:"widget"},xt=c(()=>t("div",{class:"widget-title first"},[t("h4",null,"Bài đăng Mới nhất")],-1)),It={class:"comments-list"},Lt={class:"alignleft"},Et=["href"],Tt=["src"],Vt=["href"];function St(r,l,v,o,g,h){const u=j("Layout");return d(),z(u,null,{content:A(()=>[t("div",R,[t("div",W,[t("div",X,[o.post?(d(),m("div",Z,[t("figure",null,[t("img",{src:o.post.image,alt:"",class:"img-fluid"},null,8,$)]),t("h1",null,a(o.post.title),1),t("div",tt,[t("ul",null,[t("li",null,[t("a",ot,[st,_(" "+a(o.post.category.name),1)])]),t("li",null,[et,_(" "+a(o.formatDate(o.post.created_at)),1)]),t("li",null,[t("a",nt,[lt,_(" "+a(o.post.user.name),1)])]),t("li",null,[t("a",at,[ct,_(" ("+a(o.post.comments.length)+") Bình luận",1)])])])]),t("div",{class:"post-content",innerHTML:o.post.content},null,8,it)])):C("",!0),t("div",rt,[dt,t("ul",null,[(d(!0),m(x,null,w(o.comments,s=>(d(),m("li",{key:s.id},[mt,t("div",ut,[t("div",_t,[_(a(s.name)+" ",1),ht,_(a(o.formatDateComment(s.created_at)),1)]),t("p",null,a(s.content),1)])]))),128))]),o.hasMoreComments?(d(),m("button",{key:0,onClick:l[0]||(l[0]=(...s)=>o.loadMoreComments&&o.loadMoreComments(...s)),class:"btn_1 mb-3 mt-4"}," Thêm bình luận ")):C("",!0)]),ft,gt,o.user&&o.user.name?(d(),m("div",vt,[t("div",pt,[t("div",bt,[t("div",yt,[M(t("input",{"onUpdate:modelValue":l[1]||(l[1]=s=>o.user.name=s),type:"text",class:"form-control",placeholder:"Tên"},null,512),[[k,o.user.name]])])]),t("div",Ct,[t("div",Mt,[M(t("input",{"onUpdate:modelValue":l[2]||(l[2]=s=>o.user.email=s),type:"email",class:"form-control",placeholder:"Email"},null,512),[[k,o.user.email]])])])]),t("div",kt,[M(t("textarea",{"onUpdate:modelValue":l[3]||(l[3]=s=>o.content=s),class:"form-control",rows:"6",placeholder:"Nội dung"},null,512),[[k,o.content]])]),t("div",Bt,[t("button",{type:"submit",id:"submit2",class:"btn_1 mb-3",onClick:l[4]||(l[4]=(...s)=>o.submitComment&&o.submitComment(...s))}," Bình luận ")])])):C("",!0)]),t("aside",Dt,[t("div",wt,[xt,t("ul",It,[(d(!0),m(x,null,w(o.latestPosts,s=>(d(),m("li",{key:s.id},[t("div",Lt,[t("a",{href:"/blog/posts/"+s.id},[t("img",{src:s.image,alt:""},null,8,Tt)],8,Et)]),t("small",null,a(s.category.name)+" - "+a(o.formatDate(s.created_at)),1),t("h3",null,[t("a",{href:"/blog/posts/"+s.id},a(s.title),9,Vt)])]))),128))])])])])])]),_:1})}const Gt=K(Q,[["render",St],["__scopeId","data-v-f11ba0bf"]]);export{Gt as default};
